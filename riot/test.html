<!DOCTYPE html>

<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <title>test</title>
    <meta name="description" content="${description}" />

    <style></style>
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/riot/2.2.4/riot+compiler.min.js'></script>
    <script></script>
  </head>
  <body>
    <h1>todo</h1>
    <app-li></app-li>


  </body>
</html>
<script type='riot/tag'>

  var todoList = [
    {
      action:'例：ステーキクニでご飯',
      checked:false,
      done:false,
    },
  ];
  if (localStorage.getItem('todo')) {
    var temp = localStorage.getItem('todo');
    todoList = JSON.parse(temp);

  }

  <app-li>
    <ul>
      <li each = '{todo}'><input type='checkbox' checked={checked} onclick='{check}' done=false/><span onclick="{changecontent}">{action}</span></li>
    </ul>

    <input type='textbox' id = 'todo' placeholder='please write somthing'/><br/>
    <button id='add' onclick="{add}">add</button>
    <button id='ach' onclick="{ach}">done</button>
    <button id='clear' onclick="{clear}">clear</button>


    this.todo=todoList;
    add(){
      if($('#todo').val()){
        var txt = $('#todo').val();
        todoList.push({action:txt,checked:false,done:false,});
        this.todo  = todoList;
        localStorage.setItem('todo',JSON.stringify(todoList));
      };
    }
    check(){

      $('ul').find('input[type="checkbox"]').on('change',function(){
        if(this.checked){
          this.done=true;
          $(this).parent().addClass('done');

        }else{
          this.done=false;
          $(this).parent().removeClass();

        }

      });
    }
    ach(event){
      $('ul').find('li[class = "done"]').remove();
      todoList = this.todo;
      }
    clear(event){
      this.todo.length=0;
      todoList = this.todo;
    }

    changecontent(event){
      $(this).on('click',function(){
        var tex;
        thisSpan=$(this);
        $(this).parent().append(<input type-'textbox'/>);
        $('li>input[type="textbox"]').on("focus",function(){
          $(thisSpan).addClass("hide");
          tex=$(this).val();
        }):
        $('li>input[type="textbox"]').on("blur",function(){
          $(thisSpan).text(tex);
          $(thisSpan).removeClass("hide");
        });
        todoList= this.todo;
      }
    }
  </app-li>
</script>

<script>
  riot.mount("*");
</script>
